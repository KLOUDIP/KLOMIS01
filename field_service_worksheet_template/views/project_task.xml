<odoo>
    <data>
        <record id="hide_buttons_in_task_view" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm_report.view_task_form2_inherit"/>
            <!--            <field name="inherit_id" ref="industry_fsm_report.project_task_view_form_inherit"/>-->
            <field name="arch" type="xml">
                <field name='description' position="before">
                    <field name="worksheet_template_lines" context="{'get_license':True}">
                        <tree editable="bottom">
                            <field name="select_vals"/>
                            <field name="name" readonly="1" force_save="1"/>
                            <field name="template_id" string="Worksheet Template"/>
                            <field name="fleet_id" context="{'get_license':True}"/>
                            <field name="select_user"/>
                            <field name="expense_id" column_invisible="1"/>
                            <field name="is_telematics_technicians" column_invisible="1"/>
                            <field name="done_mark" readonly="is_telematics_technicians == True"/>
                            <field name="food" column_invisible="1"/>
                            <field name="extra" column_invisible="1"/>
                            <field name="transport" column_invisible="1"/>
                            <field name="beverage" column_invisible="1"/>
                            <field name="other" column_invisible="1"/>
                            <field name="other_2" column_invisible="1"/>
                            <field name="other_3" column_invisible="1"/>

                            <button type="object" class="btn btn-primary" string='UPDATE' name="action_fsm_worksheet_template"
                                    invisible="template_id == False or done_mark==True"/>

                            <button type="object" class="btn btn-primary" string='OPEN' name="action_form_worksheet_template"
                                    invisible="template_id == False or done_mark!=True"/>

                            <button type="object" class="btn btn-primary" string='EX' name="action_open_worksheet_line_view"
                                    invisible="template_id == False"/>

                            <button type="object" class="btn btn-primary" string='SIG' name="action_preview_worksheet"
                                    invisible="template_id == False"/>

                            <button type="object" class="btn btn-primary" string='SND' name="action_worksheet_send"
                                    invisible="template_id == False"/>

                            <button type="object" class="btn btn-primary" string='FD' name="action_to_create_expense_food"
                                    invisible="template_id == False or food != False" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>

                            <button type="object" class="btn btn-primary" string='LD' name="action_to_create_expense_beverage"
                                    invisible="template_id == False or beverage != False" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>

                            <button type="object" class="btn btn-primary" string='KM' name="action_to_create_expense_transport"
                                    invisible="template_id == False or transport != False" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>

                            <button type="object" class="btn btn-primary" string='EM' name="action_to_create_expense_extra_minutes"
                                    invisible="template_id == False or extra != False" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>

                            <button type="object" class="btn btn-primary" string='OP1' name="action_to_create_expense_other" context="{'product_val': 'other'}"
                                    invisible="template_id == False or other != False" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>

                            <button type="object" class="btn btn-primary" string='OP2' name="action_to_create_expense_other" context="{'product_val': 'other_2'}"
                                    invisible="template_id == False or other_2 != False" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>

                            <button type="object" class="btn btn-primary" string='OP3' name="action_to_create_expense_other" context="{'product_val': 'other_3'}"
                                    invisible="template_id == False or other_3 != False" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>
                        </tree>
                    </field>
                </field>

                <xpath expr="//button[@name='action_fsm_worksheet']" position="replace">
                </xpath>

                <xpath expr="//div[@name='button_box']" position="after">
                    <field name="mark_as_done_rec" invisible="1"/>
                    <div role="alert" class="alert-success p-3 text-center" invisible="mark_as_done_rec == False">
                        <span class="align-middle">This Task has Done</span>
                    </div>
                </xpath>

                <div name="button_box" position="inside">
                    <field name="count" class="o_stat_value" invisible="1"/>
                    <button class="oe_stat_button" type="object" invisible="count == False"
                            name="action_for_helpdesk_ticket" icon="fa-life-ring">
                        <div class="o_stat_info">
                            <field name="helpdesk_ticket_ids_cou" class="o_stat_value"/>
                            <span class="o_stat_text"> Tickets</span>
                        </div>
                    </button>
                </div>

                <xpath expr="//field[@name='project_id']" position="after">
                    <field name="related_task"  context="{'form_view_ref': 'industry_fsm.project_task_view_form'}" invisible="1"/>
                </xpath>

                <xpath expr="//button[@name='action_send_report'][2]" position="replace">
                    <button name="action_send_report" type="object" string="Send Report" class="btn-secondary" invisible="1"/>
                </xpath>

                <xpath expr="//button[@name='action_send_report'][1]" position="replace">
                    <button name="action_send_report" type="object" string="Send Report" class="btn-secondary" invisible="1"/>
                </xpath>

                <xpath expr="//button[@name='action_preview_worksheet'][1]" position="replace">
                </xpath>

                <xpath expr="//button[@name='action_preview_worksheet']" position="replace">
                    <button name="action_preview_worksheet" type="object" string="Sign Report" class="btn-primary" invisible="1"/>
                </xpath>
            </field>
        </record>

        <record id="invoice_buttons_in_task_view" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm_sale.view_task_form2_inherit"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='action_fsm_create_quotation']" position="replace">
                    <button class="btn-secondary" name="action_fsm_create_quotation" type="object" string="New Quotation" invisible="allow_quotations == False" groups="sales_team.group_sale_salesman"/>
                </xpath>
            </field>
        </record>

        <record id="helpdesk_view" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_form2"/>
            <field name="arch" type="xml">
                <!--                <xpath expr="//group//field[@name='partner_id']" position="attributes">-->
                <!--                    <attribute name="options">{'no_open': 'True'}</attribute>-->
                <!--                </xpath>-->

                <xpath expr="//div[@name='button_box']" position="inside">
                    <field string="Tickets" name="helpdesk_ticket_id" invisible="1" />
                    <field name="is_tech_team_user" invisible="1" />
                    <button
                            string="Intervention ticket"
                            class="oe_stat_button"
                            name="action_view_ticket"
                            type="object"
                            icon="fa-life-ring"
                            invisible="helpdesk_ticket_id == False"
                            groups="helpdesk.group_helpdesk_user"
                            help="Ticket from this task"/>
                </xpath>

                <xpath expr="(//field[hasclass('o_task_state_widget')])[1]" position="attributes">
                    <attribute name="readonly">tech_team_member_id != True</attribute>
                </xpath>

                <xpath expr="(//field[hasclass('o_task_state_widget')])[2]" position="attributes">
                    <attribute name="readonly">tech_team_member_id != True</attribute>
                </xpath>

            </field>
        </record>

        <record id="view_task_form2_mark_as_done_inherit" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm.view_task_form2_inherit"/>
            <field name="arch" type="xml">
                <xpath expr="(//button[@name='action_fsm_validate'])[1]" position="replace">
                    <button
                            class="btn:primary"
                            name="action_fsm_validate"
                            type="object"
                            string="Mark as done"
                            invisible="mark_as_done_rec == False"
                            groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>
                </xpath>
                <xpath expr="(//button[@name='action_fsm_validate'])[1]" position="replace">
                    <button
                            class="btn:secondary"
                            name="action_fsm_validate"
                            type="object"
                            string="Mark as done"
                            invisible="mark_as_done_rec == False"
                            groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"
                    />
                </xpath>
                <xpath expr="(//button[@name='action_fsm_validate'])[2]" position="after">
                    <button class="btn btn-primary" name="action_task_temp" type="object" string="HelpDesk Ticket"
                            invisible="fsm_done == True" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>

                    <button class="btn btn-primary" name="action_create_new_task" type="object" string="Create New Task"
                            invisible="fsm_done == True" groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>
                </xpath>
            </field>
        </record>

        <record id="project_task_view_form_fsm_inherit" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm_report.view_task_form2_inherit"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='worksheet_template_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
            </field>
        </record>

        <record id="project_task_view_form_service_inherit" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_form2"/>
            <field name="arch" type="xml">
                <xpath expr="(//field[@name='project_id'])[2]" position="after">
                    <field name="extra_minutes" invisible="1"/>
                    <field name="tech_team_member_id"/>
                    <field name="is_technician" invisible="1"/>
                    <field name="accessible" invisible="1"/>
                    <label for="get_extra_minutes_expenses" invisible="tech_team_member_id == False or extra_minutes != False"/>
                    <div invisible="tech_team_member_id == False or extra_minutes != False">
                        <button type="object"
                                class="btn btn-primary"
                                string="EM"
                                name="get_extra_minutes_expenses"
                                groups="field_service_worksheet_template.group_coordinator_fsm,industry_fsm.group_fsm_manager"/>
                    </div>
                </xpath>

                <xpath expr="//field[@name='name']" position="replace">
                    <field name="name" class="o_task_name text-truncate" placeholder="Task Title..." default_focus="1" invisible="is_technician == True"/>
                </xpath>

            </field>
        </record>
    </data>
</odoo>

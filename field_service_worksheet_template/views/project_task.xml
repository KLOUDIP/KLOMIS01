<odoo>
    <data>
        <record id="hide_buttons_in_task_view" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm_report.project_task_view_form_inherit"/>
            <field name="arch" type="xml">
                <field name='description' position="before">
                    <field name="worksheet_template_lines">
                        <tree editable="bottom">
                            <field name="select_vals"/>
                            <field name="name" readonly="1" force_save="1"/>
                            <field name="template_id" string="Worksheet Template"/>
                            <field name="fleet_id"/>
                            <field name="select_user"/>
                            <field name="expense_id" invisible="1"/>
                            <field name="done_mark"/>
                            <field name="food" invisible="1"/>
                            <field name="extra" invisible="1"/>
                            <field name="transport" invisible="1"/>
                            <field name="beverage" invisible="1"/>

                            <field name="other" invisible="1"/>

                            <button type="object" class="btn btn-primary" string='UPDATE' name="action_fsm_worksheet_template"
                                    attrs="{'invisible': ['|', ('template_id', '=', False), ('done_mark', '=', True)]}"/>

                            <button type="object" class="btn btn-primary" string='SIGN' name="action_preview_worksheet"
                                    attrs="{'invisible': [('template_id', '=', False)]}"/>

                            <button type="object" class="btn btn-primary" string='SEND' name="action_worksheet_send"
                                    attrs="{'invisible': [('template_id', '=', False)]}"/>

                            <button type="object" class="btn btn-primary" string='FOOD' name="action_to_create_expense_food"
                                    attrs="{'invisible': ['|', ('template_id', '=', False), ('food', '!=', False)]}"/>

                            <button type="object" class="btn btn-primary" string='Lodg' name="action_to_create_expense_beverage"
                                    attrs="{'invisible': ['|', ('template_id', '=', False), ('beverage', '!=', False)]}"/>

                            <button type="object" class="btn btn-primary" string='Trans' name="action_to_create_expense_transport"
                                    attrs="{'invisible': ['|', ('template_id', '=', False), ('transport', '!=', False)]}"/>

                            <button type="object" class="btn btn-primary" string='Ext Min' name="action_to_create_expense_extra_minutes"
                                    attrs="{'invisible': ['|', ('template_id', '=', False), ('extra', '!=', False)]}"/>

                            <button type="object" class="btn btn-primary" string='Oth' name="action_to_create_expense_other"
                                    attrs="{'invisible': ['|', ('template_id', '=', False), ('other', '!=', False)]}"/>
                        </tree>
                    </field>
                </field>

                <xpath expr="//button[@name='action_fsm_create_invoice'][2]" position="after">
                    <button class="btn btn-primary" name="action_task_temp" type="object" string="HelpDesk Ticket"
                            attrs="{'invisible': [('fsm_done', '=', True)]}"/>

                    <button class="btn btn-primary" name="action_create_new_task" type="object" string="Create New Task"
                            attrs="{'invisible': [('fsm_done', '=', True)]}"/>
                </xpath>

                <xpath expr="//button[@name='action_fsm_worksheet']" position="replace">

                </xpath>

                <xpath expr="//div[@name='button_box']" position="after">
                    <field name="mark_as_done_rec" invisible="1"/>
                    <div role="alert" class="alert-success p-3 text-center"
                         attrs="{'invisible': [('mark_as_done_rec', '=', False),]}">
                        <span class="align-middle">This Task has Done</span>
                    </div>
                </xpath>

                <div name="button_box" position="inside">
                    <field name="count" class="o_stat_value" invisible="1"/>
                    <button class="oe_stat_button" type="object" attrs="{'invisible': [('count', '=', False)]}"
                            name="action_for_helpdesk_ticket" icon="fa-life-ring">
                        <div class="o_stat_info">
                            <field name="helpdesk_ticket_ids_cou" class="o_stat_value"/>
                            <span class="o_stat_text"> Tickets</span>
                        </div>
                    </button>
                </div>

                <xpath expr="//field[@name='project_id']" position="after">
                    <field name="related_task"  context="{'form_view_ref': 'industry_fsm.project_task_view_form'}"/>
                </xpath>

                <xpath expr="//button[@name='action_send_report'][2]" position="replace">
                    <button name="action_send_report" type="object" string="Send Report" class="btn-secondary" invisible="1"/>
                </xpath>
                <xpath expr="//button[@name='action_send_report'][1]" position="replace">
                    <button name="action_send_report" type="object" string="Send Report" class="btn-secondary" invisible="1"/>
                </xpath>

                <xpath expr="//button[@name='action_preview_worksheet'][1]" position="replace">
                </xpath>
                <xpath expr="//button[@name='action_preview_worksheet']" position="replace">
                    <button name="action_preview_worksheet" type="object" string="Sign Report" class="btn-primary" invisible="1"/>
                </xpath>
            </field>
        </record>

        <record id="helpdesk_view" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm.project_task_view_form"/>
            <field name="arch" type="xml">
                <xpath expr="(//field[@name='company_id'])[2]" position="after">
                    <field name="tech_team_member_id"/>
                </xpath>
                <xpath expr="//button[@name='action_view_ticket']" position="replace">
                    <button
                            string="Intervention ticket"
                            class="oe_stat_button"
                            name="action_view_ticket"
                            type="object"
                            icon="fa-life-ring"
                            attrs="{'invisible': [('helpdesk_ticket_id', '=', False)]}"
                            groups="helpdesk.group_helpdesk_user"
                            help="Ticket from this task"/>
                </xpath>
            </field>
        </record>

        <record id="project_task_view_form_fsm_inherit" model="ir.ui.view">
            <field name='name'>task.view</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm_report.project_task_view_form_inherit"/>
            <field name="arch" type="xml">
                <xpath expr="(//field[@name='worksheet_template_id'])[2]" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
            </field>
        </record>

    </data>
</odoo>
